title UC 43 - Traiter une réclamation

Acteurs: Administrateur
Lifelines:
  Administrateur
  Interface Administration (UI Admin)
  Système de Gestion Réclamations (Backend/Système)
  Base de Données (DB)
  Système de Gestion Documents (Optionnel - pour visualisation)
  Service d'Audit (Audit Service)
  Service de Notification (Optionnel - au Mutualiste)

Flux:
  Administrateur -> UI Admin: Accéder section gestion réclamations / liste réclamations à traiter
  UI Admin -> Système de Gestion Réclamations: Demander liste réclamations (selon statut/assignation)
  Système de Gestion Réclamations -> DB: Récupérer liste réclamations
  DB --> Système de Gestion Réclamations: Retourner liste
  Système de Gestion Réclamations --> UI Admin: Envoyer liste réclamations (Résumé)
  UI Admin --> Administrateur: Afficher liste des réclamations à traiter

  Administrateur -> UI Admin: Sélectionner une réclamation [ID Réclamation]
  UI Admin -> Système de Gestion Réclamations: Demander informations détaillées réclamation [ID Réclamation]

  Alt [Réclamation trouvée (Exc E1 si introuvable)]
    Système de Gestion Réclamations -> DB: Récupérer toutes les données réclamation (y compris notes, historique) [ID Réclamation]
    Opt [Documents liés (UC 45 implicite)]
      Système de Gestion Réclamations -> Système de Gestion Documents: Demander liste documents liés [ID Réclamation]
      Système de Gestion Documents --> Système de Gestion Réclamations: Retourner références documents
    DB --> Système de Gestion Réclamations: Retourner données réclamation
    Système de Gestion Réclamations --> UI Admin: Envoyer toutes les informations réclamation (données, historique, refs docs)
    UI Admin --> Administrateur: Afficher vue détaillée de la réclamation

    Administrateur -> Administrateur: Examiner réclamation et documents (UC 45 implicite pour visualiser)
    Administrateur -> UI Admin: Modifier statut, ajouter notes internes, (ré)assigner
    Administrateur -> UI Admin: Cliquer "Enregistrer modifications"

    UI Admin -> Système de Gestion Réclamations: Envoyer données de mise à jour [ID Réclamation, Données MàJ (Statut, Notes, Assignation)]

    Système de Gestion Réclamations -> Système de Gestion Réclamations: Valider données MàJ et transition statut (Alt A3)

    Alt [Validation réussie]
      Système de Gestion Réclamations -> DB: Mettre à jour enregistrement réclamation [ID Réclamation, Données MàJ]
      DB --> Système de Gestion Réclamations: Confirmation mise à jour
      Système de Gestion Réclamations -> DB: Enregistrer événement dans historique traitement [ID Réclamation, Détails action]
      DB --> Système de Gestion Réclamations: Confirmation historique
      Système de Gestion Réclamations -> Service d'Audit: Enregistrer action traitement (Qui, Quand, Sur Quoi, Détails)
      Service d'Audit --> Système de Gestion Réclamations: Confirmation audit

      Opt [Notification au Mutualiste configurée pour ce statut (Exc E3)]
        Système de Gestion Réclamations -> Service de Notification: Envoyer notification statut réclamation [ID Mutualiste, ID Réclamation, Nouveau Statut]

      Système de Gestion Réclamations --> UI Admin: Indiquer Succès Mise à Jour
      UI Admin --> Administrateur: Afficher message succès

    Alt [Validation KO (Alt A3) / Conflit (Alt A2)]
      Système de Gestion Réclamations --> UI Admin: Indiquer Échec Mise à Jour avec raisons
      UI Admin --> Administrateur: Afficher messages d'erreur / avertissement

    Alt [Erreur Système lors enregistrement (Exc E2)]
      Système de Gestion Réclamations -> Système de Gestion Réclamations: Enregistrer log d'erreur technique
      Système de Gestion Réclamations --> UI Admin: Indiquer Échec Technique
      UI Admin --> Administrateur: Afficher message générique

  Alt [Réclamation introuvable (Exc E1)]
    DB --> Système de Gestion Réclamations: Indiquer introuvable
    Système de Gestion Réclamations --> UI Admin: Indiquer erreur (réclamation introuvable)
    UI Admin --> Administrateur: Afficher message d'erreur

  Alt [Annulation par l'Administrateur (Alt A1)]
    Administrateur --> UI Admin: Cliquer "Annuler" / Quitter
    UI Admin --> Administrateur: Abandonner modifications
