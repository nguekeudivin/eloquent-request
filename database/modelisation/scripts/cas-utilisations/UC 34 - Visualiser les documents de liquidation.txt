title UC 34 - Visualiser les documents de liquidation

Acteurs: Administrateur
Lifelines:
  Administrateur
  Interface Administration (UI Admin)
  Système de Gestion Liquidations (Backend/Système)
  Système de Gestion Documents (Backend/Système)
  Base de Données (DB)
  Stockage Fichiers (Serveur/Cloud)

Flux:
  Administrateur -> UI Admin: Accéder section gestion liquidations
  Administrateur -> UI Admin: Rechercher/Sélectionner procédure de liquidation [ID Procédure]

  UI Admin -> Système de Gestion Liquidations: Demander informations procédure pour accès documents [ID Procédure]
  Système de Gestion Liquidations -> DB: Vérifier existence procédure et accès [ID Procédure]

  Alt [Procédure trouvée et accessible]
    DB --> Système de Gestion Liquidations: Confirmation procédure et références documents
    Système de Gestion Liquidations -> Système de Gestion Documents: Demander liste des documents associés [ID Procédure]
    Système de Gestion Documents -> DB: Interroger base pour métadonnées documents [ID Procédure]

    Alt [Documents trouvés]
      DB --> Système de Gestion Documents: Retourner métadonnées documents
      Système de Gestion Documents --> UI Admin: Envoyer liste des documents (Métadonnées: Nom, Type, Date, etc.)
      UI Admin --> Administrateur: Afficher liste des documents associés

      Administrateur -> UI Admin: Sélectionner un document à visualiser [ID Document]
      UI Admin -> Système de Gestion Documents: Demander accès/contenu document [ID Document]

      Système de Gestion Documents -> DB: Récupérer chemin/référence fichier physique [ID Document]
      DB --> Système de Gestion Documents: Retourner référence fichier
      Système de Gestion Documents -> Stockage Fichiers: Récupérer contenu fichier [Chemin Fichier]
      Stockage Fichiers --> Système de Gestion Documents: Retourner contenu fichier

      Alt [Fichier récupéré avec succès]
        Système de Gestion Documents --> UI Admin: Envoyer contenu document
        UI Admin --> Administrateur: Afficher document (Visionneuse intégrée ou Téléchargement)

      Alt [Fichier introuvable/corrompu (Alt A3, Exc E2)]
        Système de Gestion Documents -> Système de Gestion Documents: Enregistrer erreur fichier
        Système de Gestion Documents --> UI Admin: Indiquer Échec Accès Document
        UI Admin --> Administrateur: Afficher message d'erreur ("Document non accessible")

    Alt [Aucun document associé (Alt A2)]
      DB --> Système de Gestion Documents: Indiquer aucun document
      Système de Gestion Documents --> UI Admin: Indiquer aucun document
      UI Admin --> Administrateur: Afficher message "Aucun document associé"

    Alt [Erreur Système lors récupération liste (Exc E1)]
      Système de Gestion Documents -> Système de Gestion Documents: Enregistrer log erreur
      Système de Gestion Documents --> UI Admin: Indiquer Échec Récupération Liste Documents
      UI Admin --> Administrateur: Afficher message d'erreur générique

  Alt [Procédure introuvable/non accessible (Alt A1)]
    DB --> Système de Gestion Liquidations: Indiquer introuvable
    Système de Gestion Liquidations --> UI Admin: Indiquer erreur (procédure introuvable)
    UI Admin --> Administrateur: Afficher message d'erreur
