title UC 2 - Créer un nouveau mutualiste

Acteurs: Administrateur
Lifelines:
  Administrateur
  Interface Administration (UI Admin)
  Système de Gestion Adhérents (Backend/Système)
  Base de Données (DB)
  Service de Notification (Email/SMS Service)

Flux:
  Administrateur -> UI Admin: Accéder section gestion adhérents
  Administrateur -> UI Admin: Cliquer "Créer nouvel adhérent"
  UI Admin --> Administrateur: Afficher formulaire de création

  Administrateur -> UI Admin: Saisir informations adhérent et identifiants initiaux
  Administrateur -> UI Admin: Cliquer "Enregistrer"

  UI Admin -> Système de Gestion Adhérents: Envoyer données du nouvel adhérent

  Système de Gestion Adhérents -> Système de Gestion Adhérents: Valider données (format, obligatoire, unicité login)

  Alt [Validation réussie]
    Système de Gestion Adhérents -> DB: Créer enregistrement mutualiste
    DB --> Système de Gestion Adhérents: Confirmation création mutualiste
    Système de Gestion Adhérents -> DB: Créer compte utilisateur associé
    DB --> Système de Gestion Adhérents: Confirmation création compte utilisateur
    Système de Gestion Adhérents -> DB: Définir statut initial mutualiste ("Enregistré", "En attente validation")
    DB --> Système de Gestion Adhérents: Confirmation statut

    Système de Gestion Adhérents -> Service de Notification: Envoyer identifiants initiaux au mutualiste (Email/SMS)

    Opt [Échec envoi notification (Scénario d'Exception E2)]
      Service de Notification --> Système de Gestion Adhérents: Indiquer échec envoi
      Système de Gestion Adhérents -> Système de Gestion Adhérents: Enregistrer log échec notification
      Système de Gestion Adhérents --> UI Admin: Indiquer Succès Création AVEC avertissement échec notification
      UI Admin --> Administrateur: Afficher message succès + avertissement

    Else [Envoi notification réussi]
      Service de Notification --> Système de Gestion Adhérents: Indiquer succès envoi
      Système de Gestion Adhérents --> UI Admin: Indiquer Succès Création
      UI Admin --> Administrateur: Afficher message de succès

  Alt [Validation échoue (Scénario Alternatif A2, A3)]
    Système de Gestion Adhérents --> UI Admin: Indiquer Échec Validation avec erreurs
    UI Admin --> Administrateur: Afficher messages d'erreur sur formulaire
    UI Admin --> Administrateur: Rester sur formulaire pré-rempli

  Alt [Erreur Système (Scénario d'Exception E1)]
    Système de Gestion Adhérents -> Système de Gestion Adhérents: Enregistrer log d'erreur technique
    Système de Gestion Adhérents --> UI Admin: Indiquer Échec Technique
    UI Admin --> Administrateur: Afficher message d'erreur générique
    UI Admin --> Administrateur: Rester sur formulaire ou rediriger avec message

  Alt [Annulation par l'Administrateur (Scénario Alternatif A1)]
    Administrateur -> UI Admin: Cliquer "Annuler"
    UI Admin --> Administrateur: Rediriger vers page précédente (pas d'interaction backend)
